<app-seller-header></app-seller-header>
<div class="container-fluid">
    <div class="profile-card">
      <div class="profile-header">
        <h2>PROFILE</h2>
        <button class="edit-btn" (click)="openEditModal()">EDIT PROFILE</button>
      </div>
      <div class="profile-body">
          <div class="profile-info">
            <div class="profile">
              <p><strong>USERNAME</strong></p>
              <p style="text-transform: capitalize;">{{ userName }}</p>
            </div>
            <div class="profile">
              <p><strong>EMAIL</strong></p>
              <p>{{ email }}</p>
            </div>
            <div class="profile">
              <p><strong>PHONE NUMBER</strong></p>
              <p>{{ phone_number }}</p>
            </div>
          </div>
          <div class="d-flex flex-row justify-content-center">
            <button class="btn change-button" (click)="openChangePasswordModal()">CHANGE PASSWORD</button>
          </div>
      </div>
    </div>

    <!-- Edit Profile Modal --> 
    <div *ngIf="showModal" id="editProfileModal" class="modal">
      <div class="modal-content">
        <span class="close" (click)="closeEditModal()">&times;</span>
        <form (ngSubmit)="onSubmit()" #editProfileForm="ngForm">
          <!-- Email -->
          <div class="form-group">
            <label for="editEmail">Email:</label>
            <input type="email" id="editEmail" name="email" [(ngModel)]="email" 
                   required email #emailInput="ngModel">
            <div *ngIf="emailInput.invalid && emailInput.touched" class="error-message">
              <span *ngIf="emailInput.errors?.['required']">Email is required.</span>
              <span *ngIf="emailInput.errors?.['email']">Invalid email format.</span>
            </div>
          </div>
          
          <!-- Username -->
          <div class="form-group">
            <label for="editUsername">Username:</label>
            <input type="text" id="editUsername" name="username" [(ngModel)]="userName" 
                   required minlength="3" #usernameInput="ngModel">
            <div *ngIf="usernameInput.invalid && usernameInput.touched" class="error-message">
              <span *ngIf="usernameInput.errors?.['required']">Username is required.</span>
              <span *ngIf="usernameInput.errors?.['minlength']">Username must be at least 3 characters long.</span>
            </div>
          </div>
          
          <!-- Phone Number -->
          <div class="form-group">
            <label for="editPhone">Phone Number:</label>
            <input type="tel" id="editPhone" name="phone" [(ngModel)]="phone_number" required pattern="^[0-9]{10}$" maxlength="10" #phoneInput="ngModel" (input)="onPhoneNumberInput()">
            <div *ngIf="phoneInput.invalid && phoneInput.touched" class="error-message">
              <span *ngIf="phoneInput.errors?.['required']">Phone number is required.</span>
              <span *ngIf="phoneInput.errors?.['pattern']">Phone number must be 10 digits.</span>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" [disabled]="editProfileForm.invalid">Save Changes</button>
        </form>
      </div>
    </div>
    

    <!-- Change Password Modal --> 
    <div *ngIf="changePasswordModal" id="changePasswordModal" class="modal">
      <div class="modal-content">
        <span class="close" (click)="closeChangePasswordModal()">&times;</span>
        <form (ngSubmit)="onChangePasswordSubmit()" #changePasswordForm="ngForm">
          <!-- Current Password -->
          <div class="form-group">
            <label for="currentPassword">Current Password:</label>
            <input type="password" id="currentpassword" autocomplete="off" name="currentPassword" [(ngModel)]="currentPassword" required #currentPasswordInput="ngModel">
            <div *ngIf="currentPasswordInput.invalid && currentPasswordInput.touched" class="error-message">
              <span *ngIf="currentPasswordInput.errors?.['required']">Current password is required.</span>
            </div>
          </div>

          <!-- New Password -->
          <div class="form-group">
            <label for="newPassword">New Password:</label>
            <input type="password" id="newPassword" name="newPassword" [(ngModel)]="newPassword" required minlength="8" #newPasswordInput="ngModel">
            <div *ngIf="newPasswordInput.invalid && newPasswordInput.touched" class="error-message">
              <span *ngIf="newPasswordInput.errors?.['required']">New password is required.</span>
              <span *ngIf="newPasswordInput.errors?.['minlength']">New password must be at least 8 characters long.</span>
            </div>
          </div>

          <!-- Confirm Password -->
          <div class="form-group">
            <label for="confirmPassword">Confirm Password:</label>
            <input type="password" id="confirmPassword" name="confirmPassword" [(ngModel)]="confirmPassword" required [pattern]="newPassword" #confirmPasswordInput="ngModel">
            <div *ngIf="confirmPasswordInput.invalid && confirmPasswordInput.touched" class="error-message">
              <span *ngIf="confirmPasswordInput.errors?.['required']">Please confirm your new password.</span>
              <span *ngIf="confirmPasswordInput.errors?.['pattern']">Passwords do not match.</span>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" [disabled]="changePasswordForm.invalid">Confirm</button>
        </form>
      </div>
    </div>
</div>
